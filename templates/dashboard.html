{% extends "base.html" %}
{% block title %}ëŒ€ì‹œë³´ë“œ{% endblock %}
{% block content %}
<style>
  body { background: #f5f6fa; }
  .wrap { max-width: 480px; margin: 32px auto; padding: 0 16px 40px; }
  .hello-card { background: linear-gradient(135deg, #4f6bed 0%, #7c93ff 100%); border-radius: 16px; box-shadow: 0 16px 32px rgba(40,50,130,0.28); color: #fff; padding: 20px 24px 24px; display: flex; flex-direction: column; position: relative; overflow: hidden; }
  .hello-top { font-size: 15px; font-weight: 500; opacity: 0.9; margin-bottom: 4px; }
  .hello-name { font-size: 20px; font-weight: 600; line-height: 1.3; display: flex; align-items: baseline; gap: 8px; color: #fff; }
  .pill-status { font-size: 12px; font-weight: 500; line-height: 1.4; border-radius: 999px; padding: 3px 8px; display: inline-flex; align-items: center; gap: 4px; background: rgba(0,0,0,0.22); color: #fff; }
  .pill-dot { width: 8px; height: 8px; border-radius: 50%; background: #00ff85; box-shadow: 0 0 8px rgba(0,255,133,0.8); }
  .pill-dot.off { background: #ff4f4f; box-shadow: 0 0 8px rgba(255,79,79,0.8); }
  .hello-detail { font-size: 13px; font-weight: 400; margin-top: 12px; line-height: 1.5; color: rgba(255,255,255,0.9); }
  .stat-card, .section-card, .lucky-card { background: #fff; border-radius: 14px; box-shadow: 0 12px 28px rgba(0,0,0,0.07); padding: 16px 20px 18px; margin-top: 20px; }
  .stat-header, .lucky-head { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 10px; }
  .stat-title, .lucky-title { font-size: 14px; color: #555a75; font-weight: 600; }
  .stat-time { font-size: 22px; font-weight: 600; color: #2b2e3a; }
  .punch-wrap { margin-top: 24px; display: flex; flex-direction: column; gap: 12px; }
  .punch-btn { border: none; width: 100%; border-radius: 10px; font-size: 16px; font-weight: 600; line-height: 1.3; padding: 14px 16px; cursor: pointer; color: #fff; background: linear-gradient(135deg, #00c36a 0%, #12d47e 100%); box-shadow: 0 10px 20px rgba(0,195,106,0.35); }
  .punch-btn.out { background: linear-gradient(135deg, #e14b4b 0%, #ff6b6b 100%); box-shadow: 0 10px 20px rgba(225,75,75,0.35); }
  .link-list { display: grid; grid-template-columns: 1fr 1fr; gap: 12px 16px; font-size: 14px; line-height: 1.4; }
  .link-item a { text-decoration: none; color: #2b2e3a; font-weight: 500; display: flex; align-items: center; gap: 8px; padding: 10px 12px; border-radius: 10px; background: #f5f6fa; box-shadow: inset 0 0 0 1px rgba(0,0,0,0.03); transition: all 0.15s ease; }
  .link-item a:hover { background: #eef0ff; box-shadow: 0 8px 20px rgba(79,107,237,0.18); color: #4f6bed; }
  .foot-note { margin-top: 28px; font-size: 11px; text-align: center; color: #bbbccf; }
</style>

<div class="wrap">
  <section class="hello-card">
    <div class="hello-top">ì•ˆë…•í•˜ì„¸ìš”</div>
    <div class="hello-name">
      <div>{{ username }}ë‹˜</div>
      {% if open_rec %}
        <div class="pill-status"><div class="pill-dot"></div><div>ê·¼ë¬´ì¤‘</div></div>
      {% else %}
        <div class="pill-status"><div class="pill-dot off"></div><div>í‡´ê·¼ìƒíƒœ</div></div>
      {% endif %}
    </div>
    <div class="hello-detail">
      {% if open_rec %}
        ì§€ê¸ˆ ê·¼ë¬´ì¤‘ì´ì—ìš”. ë¬´ì‚¬íˆ ë§ˆë¬´ë¦¬í•˜ê³  ì‰¬ëŠ” ì‹œê°„ ê¼­ ì±™ê¸°ê¸° âœ¨
      {% else %}
        ì˜¤ëŠ˜ì€ ì•„ì§ ì¶œê·¼ ì•ˆ í–ˆê±°ë‚˜ ì´ë¯¸ í‡´ê·¼í–ˆì–´ìš”. ì»¨ë””ì…˜ ì˜ ì±™ê¸°ê¸° ğŸŒ™
      {% endif %}
    </div>
  </section>

  <section class="stat-card">
    <div class="stat-header">
      <div class="stat-title">ì´ë²ˆë‹¬ ëˆ„ì  ê·¼ë¬´</div>
      <div class="stat-time">{{ month_hours }}ì‹œê°„ {{ month_mins }}ë¶„</div>
    </div>

    {% if open_rec %}
      <div>ğŸ•’ ì˜¤ëŠ˜ ì¶œê·¼: <strong>{{ open_rec.time_in }}</strong></div>
    {% else %}
      <div>ğŸ•’ í˜„ì¬ ì¶œê·¼ ì¤‘ì´ ì•„ë‹™ë‹ˆë‹¤</div>
    {% endif %}

    <div class="punch-wrap">
      {% if open_rec %}
        <form method="post" action="{{ url_for('punch_out') }}">
          <button type="submit" class="punch-btn out">í‡´ê·¼í•˜ê¸°</button>
        </form>
      {% else %}
        <form method="get" action="{{ url_for('punch_form') }}">
          <button type="submit" class="punch-btn">ì¶œê·¼í•˜ê¸°</button>
        </form>
      {% endif %}
    </div>
  </section>

  <section class="lucky-card">
    <div class="lucky-head">
      <div class="lucky-title">ğŸ° ì˜¤ëŠ˜ì˜ ëŸ­í‚¤ ì´ë²¤íŠ¸</div>
      <div style="font-size:12px; color:#7e8099; font-weight:400;">1~5 ì¤‘ ì„œë¡œ ë‹¤ë¥¸ ìˆ«ì 3ê°œ</div>
    </div>
    <div>ë‚´ ì„ íƒ: {% if my_lucky_code %}<strong>{{ my_lucky_code }}</strong>{% else %}<span style="color:#7e8099;">(ì°¸ì—¬ ê¸°ë¡ ì—†ìŒ)</span>{% endif %}</div>
    {% if winning_code_today %}
      <div>ì˜¤ëŠ˜ì˜ ë‹¹ì²¨ ë²ˆí˜¸: <strong style="color:#4f6bed;">{{ winning_code_today }}</strong></div>
      {% if my_lucky_code %}
        {% if my_lucky_win %}
          <div style="color:#00a86b;">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ì˜¤ëŠ˜ì˜ í–‰ìš´ ê·¼ë¬´ì!</div>
        {% else %}
          <div style="color:#7e8099;">ì˜¤ëŠ˜ì€ ì•„ì‰½ì§€ë§Œ ë‚´ì¼ ë‹¤ì‹œ ë„ì „ ğŸ’ª</div>
        {% endif %}
      {% else %}
        <div style="color:#7e8099;">ì˜¤ëŠ˜ì€ ì°¸ì—¬í•˜ì§€ ì•Šì•˜ì–´ìš”.</div>
      {% endif %}
    {% else %}
      <div style="color:#7e8099;">ë‹¹ì²¨ ë²ˆí˜¸ëŠ” 17:00 ì´í›„ ê³µê°œë©ë‹ˆë‹¤ ğŸ”’</div>
    {% endif %}
  </section>

  <section class="section-card">
    <div class="section-title">ë‚´ ë©”ë‰´</div>
    <div class="link-list">
      <div class="link-item"><a href="{{ url_for('profiles') }}">ğŸ‘¥<span>íŒ€ ìƒíƒœíŒ</span></a></div>
      <div class="link-item"><a href="{{ url_for('weekly') }}">ğŸ“…<span>ì£¼ê°„ í˜„í™©íŒ</span></a></div>
      <div class="link-item"><a href="{{ url_for('monthly') }}">ğŸ“Š<span>ì›”ê°„ í˜„í™©íŒ</span></a></div>
      <div class="link-item"><a href="{{ url_for('board') }}">ğŸ’¬<span>íŒ€ ê²Œì‹œíŒ</span></a></div>
      <div class="link-item"><a href="{{ url_for('change_password') }}">ğŸ”<span>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</span></a></div>
      <div class="link-item"><a href="{{ url_for('logout') }}">ğŸšª<span>ë¡œê·¸ì•„ì›ƒ</span></a></div>
    </div>
    {% if is_admin %}
      <div style="font-size:11px; color:#7e8099; margin-top:8px;">ğŸ”§ ê´€ë¦¬ì ì „ìš©: <a href="{{ url_for('admin') }}" style="color:#4f6bed;">ê´€ë¦¬ì í˜ì´ì§€</a></div>
    {% endif %}
  </section>

  <div class="foot-note">Attendance System Â· local only</div>
</div>
{% endblock %}